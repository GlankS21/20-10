<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/72956b8baa.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>
<body>
    <canvas id="canvas"></canvas>
    <img id ="owl" src="https://png.pngtree.com/png-clipart/20240428/original/pngtree-an-owl-cub-with-a-beautiful-face-and-big-eyes-png-image_14965866.png" alt="">

</body>

<script>
// -------------------back-ground-----------------------------
    var canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d"),
    objects = [],
    objectsCount = 200,
    mouse = {
      x: -100,
      y: -100
    },
    minDist = 200;
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    // object image
    var image = new Image();
    image.src = 'https://manongruaz.com/wp-content/uploads/2023/04/Artboard-2@4x-8-3.png';
    
    for (var i = 0; i < objectsCount; i++) {
        let opacity = Math.random() + 0.4;
        let objectWidth = (Math.floor(Math.random() * 20) + 20) * (opacity + 0.4);
        let objectHeight = image.naturalHeight / image.naturalWidth * objectWidth;
        let speed = Math.random() * 1 + 1;
        objects.push({
            // khởi tạo kích thước image
            width: objectWidth,
            height: objectHeight,
            // vị trí bắt đầu
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height - objectHeight,
            speed: speed,
            vY: speed,
            vX: 0,
            d: Math.random() * 1.2 - 0.6,
            stepSize: (Math.random()) / 20,
            step: 0,
            angle: Math.random() * 180 - 90,
            rad: Math.random(),
            opacity: opacity,
            _ratate: Math.random() 
        });
    }

    function drawobjects() {
        objects.map((object) => {
            ctx.beginPath();
            object.rad = (object.angle * Math.PI) / 180;
            ctx.save();
            var cx = object.x + object.width / 2;
            var cy = object.y + object.height / 2;
            ctx.globalAlpha = object.opacity;
            ctx.setTransform(
                Math.cos(object.rad),
                Math.sin(object.rad),
                -Math.sin(object.rad),
                Math.cos(object.rad),
                cx - cx * Math.cos(object.rad) + cy * Math.sin(object.rad),
                cy - cx * Math.sin(object.rad) - cy * Math.cos(object.rad)
            );
            ctx.drawImage(image, object.x, object.y, object.width, object.height);
            ctx.restore();});
    }
    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawobjects();
    }
    function update() {
        objects.map((object) => {
            var dist = Math.sqrt((object.x - mouse.x) ** 2 + (object.y - mouse.y) ** 2);
            if (dist < minDist) {
                var force = minDist / (dist * dist),
                    xcomp = (mouse.x - object.x) / dist,
                    ycomp = (mouse.y - object.y) / dist,
                    deltaV = force * 2; // deplay when hover mouse
                object.vX -= deltaV * xcomp;
                object.vY -= deltaV * ycomp;
                
                if (object.d * xcomp > 0) object.d = 0 - object.d;
                else object.vX *= .98;
                if (object.vY < object.speed) object.vY = object.speed
                object.vX += Math.cos(object.step += (Math.random() * 0.05)) * object.stepSize;
            }
            object.y += object.vY;
            object.x += object.vX + object.d;
            
            var _angle = Math.random() + 0.2;
            // stuff.angle += _angle;
            if (object._ratate == 0) object.angle += _angle;
            else object.angle -= _angle;
            
            if (object.y > canvas.height) reset(object);
            if (object.x > canvas.width || object.x < (0 - object.width)) reset(object);
        });
    }
    function reset(object) {
        object.opacity = Math.random() + 0.4;
        object.width = (Math.floor(Math.random() * 20) + 20) * (object.opacity + 0.4);
        object.height = image.naturalHeight / image.naturalWidth * object.width;
        object.x = Math.floor(Math.random() * canvas.width);
        object.y = 0 - object.height;
        object.speed = Math.random() * 1 + 0.5
        object.vY = object.speed;
        object.vX = 0;
        object._ratate = Math.random();
    }
    canvas.addEventListener('mousemove', function(e){
        mouse.x = e.clientX;
        mouse.y = e.clientY;
    });
    function tick() {
        draw();
        update();
        requestAnimationFrame(tick);
    }

    tick();

// -------------------back-ground-----------------------------
</script>
</html>